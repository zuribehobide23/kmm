<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Video Adaptive</title>

  <link href="https://vjs.zencdn.net/8.20.0/video-js.css" rel="stylesheet" />

  <style>
    body { font-family: Arial; padding: 20px; }
    .quality-menu button {
      margin-right: 5px;
      padding: 5px 10px;
      cursor: pointer;
    }
    .quality-menu button.active {
      background-color: #007bff;
      color: white;
    }
    .back-button {
      display: inline-block;
      margin-top: 20px;
      padding: 10px 20px;
      background-color: #6c757d;
      color: white;
      text-decoration: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .back-button:hover {
      background-color: #5a6268;
    }
  </style>
</head>
<body>

<h2>Video Adaptativo con Video.js</h2>

<video
  id="mi-video"
  class="video-js vjs-big-play-centered"
  controls
  preload="auto"
  width="640"
  height="360"
></video>

<div class="quality-menu">
  <span>Calidad: </span>
  <button data-resolution="1080">1080p</button>
  <button data-resolution="720">720p</button>
  <button data-resolution="480">480p</button>
</div>

<a href="index.html" class="back-button">‚Üê Volver</a>

<script src="https://vjs.zencdn.net/8.20.0/video.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<script>
  const player = videojs("mi-video");
  const video = document.querySelector("video");

  // Cargar el master playlist
  if (Hls.isSupported()) {
    var hls = new Hls();
    hls.loadSource("videos/master.m3u8");
    hls.attachMedia(video);

    // Botones manuales
    const buttons = document.querySelectorAll(".quality-menu button");

    buttons.forEach(btn => {
      btn.addEventListener("click", () => {
        const res = btn.getAttribute("data-resolution");

        buttons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        if (hls.levels) {
          let index = hls.levels.findIndex(l => l.height == res);
          if (index !== -1) {
            hls.currentLevel = index;
          }
        }
      });
    });
  }
</script>

</body>
</html>
